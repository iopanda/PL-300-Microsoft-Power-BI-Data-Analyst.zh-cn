<!DOCTYPE html>
<!-- saved from url=(0148)https://microsoftlearning.github.io/PL-300-Microsoft-Power-BI-Data-Analyst/Instructions/05-create-dax-calculations-in-power-bi-desktop-advanced.html -->
<html lang="zh-CN" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>PL-300-Microsoft-Power-BI-数据分析器</title>
        
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="stylesheet" href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        <link rel="stylesheet" href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/vs.min.css">
        <script src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <link rel="stylesheet" href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/style.css">
    <link type="text/css" rel="stylesheet" charset="UTF-8" href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/translateelement.css"></head>
    <body data-spy="scroll" data-target="#linksMenu">
    <nav class="navbar navbar-expand-lg navbar-dark bg-black">
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-white" href="https://microsoftlearning.github.io/PL-300-Microsoft-Power-BI-Data-Analyst">
                <img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/Microsoft-logo_rgb_c-wht.png" alt="微软徽标" style="width:138px;height:61px;">
            </a>
            <span class="my-1 title text-white"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">微软官方课件</font></font></span>
            <a href="https://github.com/MicrosoftLearning/PL-300-Microsoft-Power-BI-Data-Analyst" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></span>
            </a>
        </div>
        <!--
        <div class="container d-flex justify-content-between">
            <a class="my-1 title text-azure text-uppercase" href="https://microsoftlearning.github.io/PL-300-Microsoft-Power-BI-Data-Analyst">
                PL-300-Microsoft-Power-BI-Data-Analyst
            </a>
            <a href="https://github.com/MicrosoftLearning/PL-300-Microsoft-Power-BI-Data-Analyst" target="_blank" class="btn btn-sm btn-outline-secondary text-light">
                <i class="fa fa-github" aria-hidden="true"></i>
                <span class="ml-2">GitHub</span>
            </a>
        </div>
        -->
    </nav>
    <div class="container">
        <main class="row extra-padding">
            <aside class="col-sm-2">       
                <nav id="linksMenu" class="toc sticky-top">
                    <ul class="nav navbar-nav flex-column">
                    <li class="nav-item"><a class="nav-link" href="https://microsoftlearning.github.io/PL-300-Microsoft-Power-BI-Data-Analyst/Instructions/05-create-dax-calculations-in-power-bi-desktop-advanced.html#exercise-1-work-with-filter-context"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">练习 1：使用过滤器上下文</font></font></a></li><li class="nav-item"><a class="nav-link" href="https://microsoftlearning.github.io/PL-300-Microsoft-Power-BI-Data-Analyst/Instructions/05-create-dax-calculations-in-power-bi-desktop-advanced.html#exercise-2-work-with-time-intelligence"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">练习 2：使用时间智能</font></font></a></li></ul>
                </nav>         
            </aside>
            <hr class="">
            <article class="col-sm-10 mb-5">
                <h1 id="create-dax-calculations-in-power-bi-desktop-part-2"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中创建 DAX 计算，第 2 部分</font></font></strong></h1>

<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成实验的预计时间为 45 分钟</font></font></strong></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本实验中，您将使用涉及筛选上下文操作的 DAX 表达式创建度量。</font></font></p>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本实验中，您将学习如何：</font></font></p>

<ul>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 CALCULATE() 函数来操作过滤器上下文</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用时间智能函数</font></font></p>
  </li>
</ul>

<h3 id="lab-story"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实验室故事</font></font></strong></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该实验室是一系列实验室中的众多实验室之一，这些实验室被设计成一个完整的故事，从数据准备到发布为报告和仪表板。</font><font style="vertical-align: inherit;">您可以按任何顺序完成实验。</font><font style="vertical-align: inherit;">但是，如果您打算通过多个实验室工作，我们建议您按以下顺序进行：</font></font></p>

<ol>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中准备数据</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中加载数据</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Power BI Desktop 中的模型数据</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中创建 DAX 计算，第 1 部分</font></font></p>
  </li>
  <li>
    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中创建 DAX 计算，第 2 部分</font></font></strong></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中设计报表，第 1 部分</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中设计报表，第 2 部分</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建 Power BI 仪表板</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中执行数据分析</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实施行级安全</font></font></p>
  </li>
</ol>

<h2 id="exercise-1-work-with-filter-context"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">练习 1：使用过滤器上下文</font></font></strong></h2>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本练习中，您将使用涉及筛选器上下文操作的 DAX 表达式创建度量。</font></font></p>

<h3 id="task-1-get-started"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务 1：开始</font></font></strong></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此任务中，您将为实验室设置环境。</font></font></p>

<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要提示：如果您从上一个实验继续（并且您成功完成了该实验），请不要完成此任务；</font><font style="vertical-align: inherit;">相反，从下一个任务继续。</font></font></em></p>

<ol>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">若要打开 Power BI Desktop，请在任务栏上单击 Microsoft Power BI Desktop 快捷方式。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image1.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image1.png" alt="图 12"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要关闭入门窗口，请单击窗口左上角的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image2.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image2.png" alt="图 11"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">若要打开初始 Power BI Desktop 文件，请单击“</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”功能区选项卡以打开后台视图。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打开报告</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image3.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image3.png" alt="图 10"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览报告</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image4.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image4.png" alt="图 9"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打开</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">窗口中，导航到</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D:\PL300\Labs\05-create-dax-calculations-in-power-bi-desktop-advanced\Starter</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件夹。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">销售分析</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打开</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image5.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image5.png" alt="图 8"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关闭所有可能打开的信息窗口。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要创建文件的副本，请单击“</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”功能区选项卡以打开后台视图。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另存为</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image6.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image6.png" alt="图 7"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果提示应用更改，请单击</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应用</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image7.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image7.png" alt="图 6"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另存为</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">窗口中，导航到</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D:\PL300\MySolution</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件夹。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image8.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image8.png" alt="图二"></a></p>
  </li>
</ol>

<h3 id="task-2-create-a-matrix-visual"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务 2：创建矩阵视觉对象</font></font></strong></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此任务中，您将创建一个矩阵视觉对象以支持测试您的新度量。</font></font></p>

<ol>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 的报表视图中，创建一个新的报表页面。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image9.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image9.png" alt="图片1"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第 3 页</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上，添加矩阵视觉对象。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image10.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image10.png" alt="图 13"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调整矩阵视觉对象的大小以填充整个页面。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要配置矩阵可视字段，请从</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">窗格中，拖动</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">区域 | </font><font style="vertical-align: inherit;">区域</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">层次结构，并将其放入视觉对象中。</font></font></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实验室使用速记符号来引用字段或层次结构。</font><font style="vertical-align: inherit;">它看起来像这样：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">区域 | </font><font style="vertical-align: inherit;">地区</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在此示例中，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是表名称，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regions</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是层次结构名称。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">销售 | </font><font style="vertical-align: inherit;">销售</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领域。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要展开整个层次结构，在矩阵视觉对象的右上角，单击叉形双箭头图标两次。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image11.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image11.png" alt="图 47"></a></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可能还记得</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regions</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">层次结构具有</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Group</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Country</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">级别。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要格式化视觉对象，请在“</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可视化</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”窗格中，选择“</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">格式</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”窗格。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image12.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image12.png" alt="图 14"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">框中，输入</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stepped</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stepped Layout</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性设置为</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Off</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image14.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image14.png" alt="图 49"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证矩阵视觉现在有四个列标题。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image15.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image15.png" alt="图 50"></a></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Adventure Works，销售区域被组织成组、国家和地区。</font><font style="vertical-align: inherit;">除美国外，所有国家都只有一个以国家命名的地区。</font><font style="vertical-align: inherit;">由于美国是一个很大的销售地区，因此分为五个销售区域。</font></font></em></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您将在本练习中创建多个度量，然后通过将它们添加到矩阵视觉对象来测试它们。</font></font></em></p>
  </li>
</ol>

<h3 id="task-3-manipulate-filter-context"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务 3：操作过滤器上下文</font></font></strong></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此任务中，您将使用 DAX 表达式创建几个度量，这些表达式使用 CALCULATE() 函数来操作过滤器上下文。</font></font></p>

<ol>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据以下表达式向</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表添加度量：</font></font></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为方便起见，本实验室中的所有 DAX 定义都可以从</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D:\PL300\Labs\05-create-dax-calculations-in-power-bi-desktop-advanced\Assets\Snippets.txt</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件中复制。</font></font></em></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock0" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock0" class="mt-0"><code class="hljs apache"> <span class="hljs-attribute"><span class="hljs-attribute">Sales</span></span> <span class="hljs-literal"><span class="hljs-literal">All</span></span> Region =<font></font>
<font></font>
 <span class="hljs-attribute"><span class="hljs-attribute">CALCULATE</span></span>(SUM(Sales[Sales]), REMOVEFILTERS(Region))
</code></pre>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CALCULATE() 函数是一个强大的函数，用于操作过滤器上下文。</font><font style="vertical-align: inherit;">第一个参数采用表达式或度量（度量只是一个命名表达式）。</font><font style="vertical-align: inherit;">后续参数允许修改过滤器上下文。</font></font></em></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REMOVEFILTERS() 函数删除活动过滤器。</font><font style="vertical-align: inherit;">它可以不使用参数，也可以使用表、列或多列作为参数。</font></font></em></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此公式中，该度量评估修改后的筛选上下文中的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列的总和，这会删除应用于</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表列的所有筛选器。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales All Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量添加到矩阵视觉对象。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image16.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image16.png" alt="图 52"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales All Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量计算每个区域、国家（小计）和组（小计）的所有区域销售额的总和。</font></font></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新措施尚未产生有用的结果。</font><font style="vertical-align: inherit;">当一个组、国家或地区的销售额除以这个值时，它将产生一个有用的比率，称为“总百分比”。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">窗格中，确保选中</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales All Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量（选中后，它将具有深灰色背景），然后在公式栏中，将度量名称和公式替换为以下公式：</font></font></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提示：要替换现有公式，请先复制代码段。</font><font style="vertical-align: inherit;">然后，在编辑栏内单击并按</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl+A</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以选择所有文本。</font><font style="vertical-align: inherit;">然后，按</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl+V</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">粘贴片段以覆盖所选文本。</font><font style="vertical-align: inherit;">然后按</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enter</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></em></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock1" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock1" class="mt-0"><code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">Sales</span></span> % All Region =  <font></font>
 ‎DIVIDE(  <font></font>
 ‎ SUM(Sales[Sales]),  <font></font>
 ‎ CALCULATE(  <font></font>
 ‎ SUM(Sales[Sales]),  <font></font>
 ‎ REMOVEFILTERS(Region)  <font></font>
 ‎ )  <font></font>
 ‎)<font></font>
</code></pre>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该度量已重命名以准确反映更新的公式。</font><font style="vertical-align: inherit;">DIVIDE() 函数将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量（未由过滤器上下文修改）除以修改上下文中的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量，这会删除应用于</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表的任何过滤器。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在矩阵视觉对象中，请注意该度量已重命名，并且现在为每个组、国家和地区显示不同的值。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将Sales % All Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量格式化</font><font style="vertical-align: inherit;">为带两位小数的百分比。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在矩阵视觉对象中，查看</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % All Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量值。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image17.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image17.png" alt="图 53"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据以下表达式，</font><font style="vertical-align: inherit;">将另一个度量添加到</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales表，并将格式设置为百分比：</font></font></strong><font style="vertical-align: inherit;"></font></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock2" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock2" class="mt-0"><code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">Sales</span></span> % Country =  <font></font>
 ‎DIVIDE(  <font></font>
 ‎ SUM(Sales[Sales]),  <font></font>
 ‎ CALCULATE(  <font></font>
 ‎ SUM(Sales[Sales]),  <font></font>
 ‎ REMOVEFILTERS(Region[Region])  <font></font>
 ‎ )  <font></font>
 ‎)<font></font>
</code></pre>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % Country度量公式与</font></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % All Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量公式略有不同</font><font style="vertical-align: inherit;">。</font></font></p>

    <p><em><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">不同之处在于，分母通过删除Region表的</font></strong></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">上的过滤器来修改过滤器上下文，而不是</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Region</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表的所有列</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这意味着应用到组或国家列的任何过滤器都会被保留。</font><font style="vertical-align: inherit;">它将实现代表销售额占国家/地区百分比的结果。</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % Country</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量添加到矩阵视觉对象。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，只有美国地区产生的值不是 100%。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image18.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image18.png" alt="图 54"></a></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可能还记得只有美国有多个地区。</font><font style="vertical-align: inherit;">所有其他国家都包含一个区域，这解释了为什么它们都是 100%。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了提高此度量在视觉上的可读性，请</font><font style="vertical-align: inherit;">使用此改进的公式覆盖</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % Country度量。</font></font></strong><font style="vertical-align: inherit;"></font></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock3" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock3" class="mt-0"><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Sales</span></span> % Country =  <font></font>
‎IF(  <font></font>
‎ ISINSCOPE(Region[Region]),  <font></font>
‎ DIVIDE(  <font></font>
‎ SUM(Sales[Sales]),  <font></font>
‎ CALCULATE(  <font></font>
‎ SUM(Sales[Sales]),  <font></font>
‎ REMOVEFILTERS(Region[Region])  <font></font>
‎ )  <font></font>
‎ )  <font></font>
‎)<font></font>
</code></pre>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入在 IF() 函数中的 ISINSCOPE() 函数用于测试区域列是否是层次结构中的层次。</font><font style="vertical-align: inherit;">如果为真，则评估 DIVIDE() 函数。</font><font style="vertical-align: inherit;">没有错误部分意味着当区域列不在范围内时返回空白。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % Country</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量现在仅在区域在范围内时返回一个值。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image19.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image19.png" alt="图 55"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据以下表达式，</font><font style="vertical-align: inherit;">将另一个度量添加到</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales表，并将格式设置为百分比：</font></font></strong><font style="vertical-align: inherit;"></font></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock4" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock4" class="mt-0"><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Sales</span></span> % Group =  <font></font>
‎DIVIDE(  <font></font>
‎ SUM(Sales[Sales]),  <font></font>
‎ CALCULATE(  <font></font>
‎ SUM(Sales[Sales]),  <font></font>
‎ REMOVEFILTERS(  <font></font>
‎ Region[Region],  <font></font>
‎ Region[Country]  <font></font>
‎ )  <font></font>
‎ )  <font></font>
‎)<font></font>
</code></pre>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了实现销售额占组的百分比，可以应用两个过滤器来有效地删除两列上的过滤器。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % Group</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量添加到矩阵视觉对象。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要提高此度量在视觉上的可读性，请</font><font style="vertical-align: inherit;">使用此改进的公式覆盖</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % Group度量。</font></font></strong><font style="vertical-align: inherit;"></font></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock5" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock5" class="mt-0"><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Sales</span></span> % Group =  <font></font>
‎IF(  <font></font>
‎ ISINSCOPE(Region[Region])  <font></font>
‎ || ISINSCOPE(Region[Country]),  <font></font>
‎ DIVIDE(  <font></font>
‎ SUM(Sales[Sales]),  <font></font>
‎ CALCULATE(  <font></font>
‎ SUM(Sales[Sales]),  <font></font>
‎ REMOVEFILTERS(  <font></font>
‎ Region[Region],  <font></font>
‎ Region[Country]  <font></font>
‎ )  <font></font>
‎ )  <font></font>
‎ )  <font></font>
‎)<font></font>
</code></pre>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales % Group</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量现在仅在区域或国家/地区在范围内时返回一个值。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在模型视图中，将三个新度量放入名为</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ratios</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的显示文件夹中。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image20.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image20.png" alt="图 56"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存 Power BI Desktop 文件。</font></font></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加到</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">销售</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表的度量已修改筛选上下文以实现分层导航。</font><font style="vertical-align: inherit;">请注意，实现小计计算的模式需要从过滤器上下文中删除一些列，并且要达到总计，必须删除所有列。</font></font></em></p>
  </li>
</ol>

<h2 id="exercise-2-work-with-time-intelligence"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">练习 2：使用时间智能</font></font></strong></h2>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本练习中，您将创建年初至今的销售额 (YTD) 度量和销售额同比 (YoY) 增长度量。</font></font></p>

<h3 id="task-1-create-a-ytd-measure"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务 1：创建 YTD 度量</font></font></strong></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此任务中，您将创建一个销售 YTD 度量。</font></font></p>

<ol>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在报告视图的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第 2 页</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上，请注意矩阵视觉对象，其中显示了各种度量，其中年份和月份分组在行上。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据以下表达式将度量添加到</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，并格式化为零小数位：</font></font></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock6" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock6" class="mt-0"><code class="hljs javascript"> Sales YTD =  <font></font>
 ‎TOTALYTD(SUM(Sales[Sales]), <span class="hljs-string"><span class="hljs-string">'Date'</span></span>[<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>], <span class="hljs-string"><span class="hljs-string">"6-30"</span></span>)
</code></pre>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TOTALYTD() 函数对</font><font style="vertical-align: inherit;">给定日期列上的表达式（在本例中为</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales列的总和）求值。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日期列必须属于标记为日期表的日期表，如</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 Power BI Desktop 中创建 DAX 计算，第 1 部分</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实验室中所做的那样。</font></font></em></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该函数还可以采用第三个可选参数，表示一年中的最后一个日期。</font><font style="vertical-align: inherit;">没有这个日期意味着 12 月 31 日是一年中的最后一个日期。</font><font style="vertical-align: inherit;">对于 Adventure Works，他们一年中的最后一个月是六月，因此使用“6-30”。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段和</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales YTD</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量添加到矩阵视觉对象。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意一年内销售价值的累积。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image21.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image21.png" alt="图 59"></a></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TOTALYTD() 函数执行过滤器操作，特别是时间过滤器操作。</font><font style="vertical-align: inherit;">例如，要计算 2017 年 9 月（财政年度的第三个月）的年初至今销售额，</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日期</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表上的所有过滤器都将被删除并替换为从年初（2017 年 7 月 1 日）开始的新日期过滤器，并且延长至上下文日期期间的最后一个日期（2017 年 9 月 30 日）。</font></font></em></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，DAX 中提供了许多时间智能函数来支持常见的时间过滤器操作。</font></font></em></p>
  </li>
</ol>

<h3 id="task-2-create-a-yoy-growth-measure"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务 2：创建同比增长度量</font></font></strong></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此任务中，您将创建销售额同比增长度量。</font></font></p>

<ol>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据以下表达式向</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表添加一个附加度量：</font></font></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock7" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock7" class="mt-0"><code class="hljs php"> Sales YoY Growth =  <font></font>
 ‎<span class="hljs-keyword"><span class="hljs-keyword">VAR</span></span> SalesPriorYear =  <font></font>
 ‎ CALCULATE(  <font></font>
 ‎ SUM(Sales[Sales]),  <font></font>
 ‎ PARALLELPERIOD(  <font></font>
 ‎ <span class="hljs-string"><span class="hljs-string">'Date'</span></span>[Date],  <font></font>
 ‎ <span class="hljs-number"><span class="hljs-number">-12</span></span>,  <font></font>
 ‎ MONTH  <font></font>
 ‎ )  <font></font>
 ‎ )  <font></font>
 ‎<span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span>  <font></font>
 ‎ SalesPriorYear<font></font>
</code></pre>

    <p><em><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales YoY Growth</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量公式声明了一个变量</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">变量可用于简化公式逻辑，并且在需要在公式中多次评估表达式时更有效（这将是 YoY 增长逻辑的情况）。</font><font style="vertical-align: inherit;">变量由唯一的名称声明，然后必须在</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RETURN</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字之后输出度量表达式。</font></font></em></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SalesPriorYear</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量分配了一个表达式，该表达式计算修改后的上下文中</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列的总和，该修改后的上下文使用 PARALLELPERIOD() 函数将过滤上下文中的每个日期向后移动 12 个月。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales YoY Growth</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量添加到矩阵视觉对象。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，新度量在前 12 个月返回空白（因为在 2017 财年之前没有记录销售）。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，</font><strong><font style="vertical-align: inherit;">2018 年 7 月的</font></strong></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">销售额同比增长</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量值是</font><strong><font style="vertical-align: inherit;">2017</font></strong><font style="vertical-align: inherit;">年 7 月的</font><strong><font style="vertical-align: inherit;">销售额</font></strong><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">。</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image22.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image22.png" alt="图 61"></a></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在公式的“困难部分”已经测试过了，您可以用计算增长结果的最终公式覆盖度量。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要完成该度量，请使用此公式覆盖</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sales YoY Growth</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度量，并将其格式化为带两位小数的百分比：</font></font></p>

    <p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">达克斯</font></font></strong></p>

    <div class="code-header mt-3 mb-0 bg-light d-flex justify-content-between border"><span class="mx-2 text-muted text-capitalize font-weight-light"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></span><button class="m-0 btn btn-code btn-sm btn-light codeBtn rounded-0 border-left text-muted font-weight-light" data-clipboard-target="#codeBlock8" type="button"><i class="fa fa-files-o mr-2" aria-hidden="true"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></button></div><pre id="codeBlock8" class="mt-0"><code class="hljs php"> Sales YoY Growth =  <font></font>
 ‎<span class="hljs-keyword"><span class="hljs-keyword">VAR</span></span> SalesPriorYear =  <font></font>
 ‎ CALCULATE(  <font></font>
 ‎ SUM(Sales[Sales]),  <font></font>
 ‎ PARALLELPERIOD(  <font></font>
 ‎ <span class="hljs-string"><span class="hljs-string">'Date'</span></span>[Date],  <font></font>
 ‎ <span class="hljs-number"><span class="hljs-number">-12</span></span>,  <font></font>
 ‎ MONTH  <font></font>
 ‎ )  <font></font>
 ‎ )  <font></font>
 ‎<span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span>  <font></font>
 ‎ DIVIDE(  <font></font>
 ‎ (SUM(Sales[Sales]) - SalesPriorYear),  <font></font>
 ‎ SalesPriorYear  <font></font>
 ‎ )<font></font>
</code></pre>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在公式中的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RETURN</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中，请注意变量被引用了两次。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2018 年 7 月</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的 YoY 增长为</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">392.83%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image23.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image23.png" alt="图 62"></a></p>

    <p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这意味着 2018 年 7 月的销售额（2,411,559 美元）比去年同期的销售额（489,328 美元）提高了近 400%（几乎是 4 倍）。</font></font></em></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在模型视图中，将两个新度量放入名为</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Time Intelligence</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的显示文件夹中。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image24.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image24.png" alt="图 63"></a></p>
  </li>
</ol>

<h3 id="task-3-finish-up"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任务 3：完成</font></font></strong></h3>

<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此任务中，您将完成实验。</font></font></p>

<ol>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要清理为报表开发做好准备的解决方案，请在左下角右键单击</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">页选项卡，然后选择</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">页面。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image25.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image25.png" alt="图 17"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当提示删除页面时，单击</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>

    <p><a href="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image26.png" target="_blank"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/06-create-dax-calculations-in-power-bi-desktop-advanced_image26.png" alt="图 18"></a></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也删除</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第 3 页</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在剩余页面上，要清除页面，请选择表格视觉对象，然后按</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Delete</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">键。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存 Power BI Desktop 文件。</font></font></p>
  </li>
  <li>
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果你打算开始下一个实验室，请将 Power BI Desktop 保持打开状态。</font></font></p>

    <p><em><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你将根据在 Power BI Desktop 中设计报表，第 1 部分</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实验室</font><font style="vertical-align: inherit;">中的数据模型创建报表。</font></font></em></p>
  </li>
</ol>

            </article>
        </main>
    </div>
    <footer class="fixed-bottom d-print-none">
        <nav class="navbar navbar-light bg-light d-flex justify-content-around">
            <span class="navbar-text">
                <i class="fa fa-github" aria-hidden="true"></i>
                <a href="https://github.com/MicrosoftLearning/PL-300-Microsoft-Power-BI-Data-Analyst" target="_blank" class="ml-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    MicrosoftLearning/PL-300-Microsoft-Power-BI-Data-Analyst
                </font></font></a>
            </span>
        </nav>
    </footer>
    <script src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script><div style="position: static !important;"></div>
    <script src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/clipboard.min.js"></script>
    <script src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/highlight.min.js"></script>
    <script src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/script.js"></script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./05-create-dax-calculations-in-power-bi-desktop-advanced_files/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>



<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>